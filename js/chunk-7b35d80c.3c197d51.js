(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b35d80c"],{1086:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pool-view"},[e("div",{staticClass:"container mini"},[e("BackButton",{attrs:{text:"Stand"},on:{click:t.toStand}}),e("h1",[t._v("Get some WETC here")]),e("div",{staticClass:"pool-head-bar"},[e("div",{staticClass:"btns-group"},[e("button",{staticClass:"btn mini borrow-btn",class:{active:"borrow"===t.actionType},on:{click:function(e){return t.setActionType("borrow")}}},[t._v(" Deposite ")]),e("button",{staticClass:"btn mini replay-btn",class:{active:"repay"===t.actionType},on:{click:function(e){return t.setActionType("repay")}}},[t._v(" Withdraw ")])])]),e("div",{staticClass:"pool-content"},[e("DepositeWithdrawComponent",{attrs:{actionType:t.actionType,balance:t.pool.userBalance,pairBalance:t.pool.userPairBalance,isUpdatePrice:t.pool.askUpdatePrice,tokenName:t.pool.token.name,tokenToUsd:t.pool.tokenPrice,tokenDecimals:t.pool.token.decimals,tokenPair:t.pool.tokenPairPrice,tokenPairName:t.pool.pairToken.name,tokenPairDecimals:t.pool.pairToken.decimals,userTotalCollateral:t.pool.userCollateralShare,userTotalBorrowed:t.pool.userBorrowPart,ltv:t.pool.ltv},on:{depositeEtc:t.depositeEtcHandler,withdrawEtc:t.withdrawEtcHandler}})],1)],1)])},s=[],i=(n("14d9"),n("c0d8")),o=n.n(i);const r=()=>n.e("chunk-1960fe00").then(n.bind(null,"a8da")),p=()=>n.e("chunk-0cf3d7d2").then(n.bind(null,"3380"));var u={data(){return{actionType:"borrow",gasLimitConst:1e3}},computed:{pool(){const t=2;return this.$store.getters.getPoolById(t)},signer(){return this.$store.getters.getSigner},account(){return this.$store.getters.getAccount}},methods:{setActionType(t){t!==this.actionType&&(this.actionType=t)},toStand(){this.$router.push({name:"Stand"})},async depositeEtcHandler(t){const e=await ethereum.request({method:"eth_requestAccounts"}),n=e[0],a=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"src",type:"address"},{indexed:!0,internalType:"address",name:"guy",type:"address"},{indexed:!1,internalType:"uint256",name:"wad",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"dst",type:"address"},{indexed:!1,internalType:"uint256",name:"wad",type:"uint256"}],name:"Deposit",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"src",type:"address"},{indexed:!0,internalType:"address",name:"dst",type:"address"},{indexed:!1,internalType:"uint256",name:"wad",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"src",type:"address"},{indexed:!1,internalType:"uint256",name:"wad",type:"uint256"}],name:"Withdrawal",type:"event"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"guy",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"deposit",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"dst",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"src",type:"address"},{internalType:"address",name:"dst",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"wad",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}],s=this.pool.token.contract.address;web3=new o.a(window.web3.currentProvider);const i=new web3.eth.Contract(a,s);await i.methods.deposit().send({from:n,value:t.amount})},async withdrawEtcHandler(t){const e=await ethereum.request({method:"eth_requestAccounts"}),n=e[0],a=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"src",type:"address"},{indexed:!0,internalType:"address",name:"guy",type:"address"},{indexed:!1,internalType:"uint256",name:"wad",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"dst",type:"address"},{indexed:!1,internalType:"uint256",name:"wad",type:"uint256"}],name:"Deposit",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"src",type:"address"},{indexed:!0,internalType:"address",name:"dst",type:"address"},{indexed:!1,internalType:"uint256",name:"wad",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"src",type:"address"},{indexed:!1,internalType:"uint256",name:"wad",type:"uint256"}],name:"Withdrawal",type:"event"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"guy",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"deposit",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"dst",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"src",type:"address"},{internalType:"address",name:"dst",type:"address"},{internalType:"uint256",name:"wad",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"wad",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}],s=this.pool.token.contract.address;web3=new o.a(window.web3.currentProvider);const i=new web3.eth.Contract(a,s);await i.methods.withdraw(t.amount).send({from:n})},async cookAddCollateral({amount:t,updatePrice:e},n){const a=this.getDepositEncode(t),s=this.getAddCollateralEncode();await this.getGasPrice();if(n){if(e){const t=this.getUpdateRateEncode(),e=await this.pool.contractInstance.estimateGas.cook([11,20,10],[0,0,0],[t,a,s],{value:0}),n=this.gasLimitConst+ +e.toString();await this.pool.contractInstance.cook([11,20,10],[0,0,0],[t,a,s],{value:0,gasLimit:n});return!1}const t=await this.pool.contractInstance.estimateGas.cook([20,10],[0,0],[a,s],{value:0}),n=this.gasLimitConst+ +t.toString();await this.pool.contractInstance.cook([20,10],[0,0],[a,s],{value:0,gasLimit:n});return!1}const i=await this.getApprovalEncode();if("ledger"===i){const t=await this.approveMasterContract();if(!t)return!1;if(e){const t=this.getUpdateRateEncode(),e=await this.pool.contractInstance.estimateGas.cook([11,20,10],[0,0,0],[t,a,s],{value:0}),n=this.gasLimitConst+ +e.toString();await this.pool.contractInstance.cook([11,20,10],[0,0,0],[t,a,s],{value:0,gasLimit:n});return!1}const n=await this.pool.contractInstance.estimateGas.cook([20,10],[0,0],[a,s],{value:0}),i=this.gasLimitConst+ +n.toString();await this.pool.contractInstance.cook([20,10],[0,0],[a,s],{value:0,gasLimit:i});return!1}if(e){const t=this.getUpdateRateEncode(),e=await this.pool.contractInstance.estimateGas.cook([24,11,20,10],[0,0,0,0],[i,t,a,s],{value:0}),n=this.gasLimitConst+ +e.toString();await this.pool.contractInstance.cook([24,11,20,10],[0,0,0,0],[i,t,a,s],{value:0,gasLimit:n});return!1}const o=8e6;await this.pool.contractInstance.cook([24,20,10],[0,0,0],[i,a,s],{value:0,gasLimit:o})},async getApprovalEncode(){const t=this.account,e=await this.getVerifyingContract(),n=await this.getMasterContract(),a=await this.getNonce(),s=this.$store.getters.getActiveChain.code,i={name:"BentoBox V1",chainId:s,verifyingContract:e},o={SetMasterContractApproval:[{name:"warning",type:"string"},{name:"user",type:"address"},{name:"masterContract",type:"address"},{name:"approved",type:"bool"},{name:"nonce",type:"uint256"}]},r={warning:"Give FULL access to funds in (and approved to) BentoBox?",user:t,masterContract:n,approved:!0,nonce:a};let p;try{p=await this.signer._signTypedData(i,o,r)}catch(c){return-32603===c.code&&"ledger"}const u=this.parseSignature(p);return this.$ethers.utils.defaultAbiCoder.encode(["address","address","bool","uint8","bytes32","bytes32"],[t,n,!0,u.v,u.r,u.s])},parseSignature(t){const e=t.substring(2);var n=e.substring(0,64),a=e.substring(64,128),s=e.substring(128,130);return{r:"0x"+n,s:"0x"+a,v:parseInt(s,16)}},async getGasPrice(){try{const t=await this.signer.getGasPrice();return t}catch(t){}},async getMasterContract(){try{const t=await this.pool.contractInstance.masterContract();return t}catch(t){}},async getVerifyingContract(){try{const t=await this.pool.contractInstance.bentoBox();return t}catch(t){}},async isApprowed(){try{const t=await this.getMasterContract(),e=await this.pool.masterContractInstance.masterContractApproved(t,this.account);return e}catch(t){}},async isTokenApprowed(t,e){try{const n=await t.allowance(this.account,e,{gasLimit:1e6});return parseFloat(n.toString())>0}catch(n){return!1}},async approveToken(t,e){try{const n=await t.estimateGas.approve(e,"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),a=this.gasLimitConst+ +n.toString(),s=await t.approve(e,"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",{gasLimit:a});await s.wait();return!0}catch(n){return!1}},async approveMasterContract(){try{const t=await this.getMasterContract(),e=await this.pool.masterContractInstance.setMasterContractApproval(this.account,t,!0,this.$ethers.utils.formatBytes32String(""),this.$ethers.utils.formatBytes32String(""),this.$ethers.utils.formatBytes32String("")),n=await e.wait();return n}catch(t){return!1}},async getNonce(){try{const t=await this.pool.masterContractInstance.nonces(this.account);return t.toString()}catch(t){}}},async created(){const t=this.$store.getters.getWalletIsConnected;if(!t)return this.$router.push({name:"Home"}),alert("Connect wallet first"),!1;const e=2,n=this.$store.getters.getPoolById(e);if(!n)return this.$router.push({name:"Stand"}),!1;!this.$route.query.actionType||"borrow"!==this.$route.query.actionType&&"repay"!==this.$route.query.actionType||this.setActionType(this.$route.query.actionType)},components:{DepositeWithdrawComponent:r,BackButton:p}},c=u,d=(n("a8e0"),n("2877")),y=Object(d["a"])(c,a,s,!1,null,"aed9eda8",null);e["default"]=y.exports},"2a78":function(t,e,n){},a8e0:function(t,e,n){"use strict";n("2a78")}}]);