(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-211f071c"],{"0d98":function(t,a,e){t.exports=e.p+"img/close-popup.cb7e35ba.svg"},"5c1f":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t._self._c;return a("div",{staticClass:"swap-popup"},[a("img",{staticClass:"close-btn",attrs:{src:e("0d98"),alt:""},on:{click:t.closePopup}}),a("p",{staticClass:"title"},[t._v(t._s(t.action))]),a("p",{staticClass:"subtitle"},[t._v(" Make SPELL work for you! Stake your SPELL and gain sSPELL. No impermanent loss, no loss of governance rights. Continuously compounding. After each new deposit, all staked SPELL are subject to a 24H lock-up period! ")]),a("p",{staticClass:"subtiitle"},[t._v(" sSPELL automatically earns fees from MIM repayments from all wizards proportional to your share of the stake pool. ")]),a("p",{staticClass:"balance-text"},[t._v(" Balance: "+t._s(parseFloat(t.balance||0).toFixed(4))+" ")]),a("div",{staticClass:"target-row"},[a("p",{staticClass:"label-text"},[t._v("From")]),a("ValueInput",{attrs:{max:t.balance||0,valueName:t.fromToken,parentValue:t.amount,error:t.amountError},on:{onchange:t.updateMainValue}})],1),a("img",{staticClass:"swap-icon",attrs:{src:e("8d35"),alt:""}}),a("div",{staticClass:"target-row to-row"},[a("p",{staticClass:"label-text"},[t._v("To")]),a("ValueInput",{attrs:{valueName:t.toToken,parentValue:t.toTokenAmount,disabled:!0}})],1),a("button",{staticClass:"btn approve-btn",attrs:{disabled:!t.amount},on:{click:t.actionHandler}},[t._v(" "+t._s(t.action)+" ")])])},s=[];const o=()=>e.e("chunk-6bc0cf3f").then(e.bind(null,"6618"));var i={data(){return{balance:"",action:"",amount:"",amountError:"",tokenRate:1}},computed:{sSpellTokenObject(){return this.$store.getters.getSSpellObject},fromToken(){return"stake"===this.action?this.sSpellTokenObject.stakeToken.name:"unstake"===this.action?this.sSpellTokenObject.mainToken.name:""},toToken(){return"stake"===this.action?this.sSpellTokenObject.mainToken.name:"unstake"===this.action?this.sSpellTokenObject.stakeToken.name:""},toTokenAmount(){if(!this.amount)return"";let t=new RegExp("^-?\\d+(?:.\\d{0,6})?");if("stake"===this.action){const a=this.amount/this.tokenRate;return a.toString().match(t)[0]}if("unstake"===this.action){const a=this.amount*this.tokenRate;return a.toString().match(t)[0]}return""},account(){return this.$store.getters.getAccount}},methods:{closePopup(){this.$emit("close")},updateMainValue(t){if(+t>+this.balance)return this.amountError="The value cannot be greater than "+this.balance,!1;this.amountError="",this.amount=t},async getBalance(){let t;"stake"===this.action&&(t=this.sSpellTokenObject.stakeToken.contractInstance),"unstake"===this.action&&(t=this.sSpellTokenObject.mainToken.contractInstance);try{const a=await t.balanceOf(this.account);this.balance=this.$ethers.utils.formatEther(a.toString())}catch(a){}},async getSpellRate(){const t=this.sSpellTokenObject.stakeToken.contractInstance,a=this.sSpellTokenObject.mainToken.contractInstance;try{const e=await t.balanceOf(a.address),n=await a.totalSupply(),s=this.$ethers.utils.formatEther(e.toString()),o=this.$ethers.utils.formatEther(n),i=s/o;return i}catch(e){}},async actionHandler(){if("stake"===this.action){const t=await this.isTokenApprowed(this.sSpellTokenObject.stakeToken.contractInstance);if(t)return await this.stake(),!1;const a=await this.approveToken(this.sSpellTokenObject.stakeToken.contractInstance);a&&await this.stake()}"unstake"===this.action&&await this.unstake()},async stake(){try{const t=this.$ethers.utils.parseEther(this.amount),a=await this.sSpellTokenObject.mainToken.contractInstance.estimateGas.mint(t),e=+a.toString()+1e3,n=await this.sSpellTokenObject.mainToken.contractInstance.mint(t,{gasLimit:e});this.closePopup();await n.wait()}catch(t){}},async unstake(){try{const t=this.$ethers.utils.parseEther(this.amount),a=await this.sSpellTokenObject.mainToken.contractInstance.estimateGas.burn(this.account,t),e=+a.toString()+1e3,n=await this.sSpellTokenObject.mainToken.contractInstance.burn(this.account,t,{gasLimit:e});this.closePopup();await n.wait()}catch(t){}},async isTokenApprowed(t){try{const a=await t.allowance(this.account,this.sSpellTokenObject.mainToken.contractInstance.address,{gasLimit:1e6});return parseFloat(a.toString())>0}catch(a){return!1}},async approveToken(t){try{const a=await t.estimateGas.approve(this.sSpellTokenObject.mainToken.contractInstance.address,"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),e=+a.toString()+1e3,n=await t.approve(this.sSpellTokenObject.mainToken.contractInstance.address,"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",{gasLimit:e});await n.wait();return!0}catch(a){return!1}}},async created(){const t=this.$store.getters.getPopupData.type;t||this.$emit("close"),this.action=t,await this.getBalance(),this.tokenRate=await this.getSpellRate()},components:{ValueInput:o}},c=i,r=(e("e670"),e("2877")),f=Object(r["a"])(c,n,s,!1,null,"51cbf79d",null);a["default"]=f.exports},"8d35":function(t,a,e){t.exports=e.p+"img/pixel-two-arrow.2cf78671.svg"},c279:function(t,a,e){},e670:function(t,a,e){"use strict";e("c279")}}]);