(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20c2f7eb"],{"4c09":function(e,t,a){"use strict";a("f612")},"57e9":function(e,t,a){e.exports=a.p+"img/i-icon.4b7942a4.svg"},cba4:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deposit-borrow-block"},["borrow"===e.actionType?t("h3",[e._v("Deposit collateral")]):e._e(),"repay"===e.actionType?t("h3",[e._v("Repay "+e._s(e.tokenPairName))]):e._e(),t("div",{staticClass:"input-wrap"},[t("ValueInput",{attrs:{max:e.maxMainValue,parentValue:e.mainValue,error:e.mainValueError,valueName:e.mainValueTokenName},on:{onchange:e.updateMainValue}})],1),"borrow"===e.actionType?t("h3",[e._v("Borrow "+e._s(e.tokenPairName))]):e._e(),"repay"===e.actionType?t("h3",[e._v("Remove collateral")]):e._e(),t("div",{staticClass:"input-wrap"},[t("ValueInput",{attrs:{max:e.maxPairValue,showMax:e.showMax,valueName:e.pairValueTokenName,parentValue:e.pairValue,error:e.pairValueError},on:{onchange:e.updatePairValue}})],1),"borrow"===e.actionType?t("div",{staticClass:"config-box"},[t("LiquidationRules",{attrs:{liquidationPrice:e.liquidationPrice,maxValue:e.ltv,value:e.percentValue},on:{onchange:e.updatePercentValue}})],1):e._e(),"borrow"===e.actionType?t("div",{staticClass:"config-box"},[e.showLeverage?[t("transition",{attrs:{name:"fade"}},[t("SlipageBlock",{attrs:{slipage:e.slipage},on:{update:e.updateSlipage}})],1),t("transition",{attrs:{name:"fade"}},[t("LeverageBar",{attrs:{multiplier:e.multiplier},on:{update:e.updateMultiplier}})],1)]:e._e()],2):e._e(),t("div",{staticClass:"action-wrap"},[t("div",{staticClass:"checkbox-wrap"},[t("div",{staticClass:"box-wrap",class:{active:e.updatePrice},on:{click:e.toggleUpdatePrice}},[t("div",{staticClass:"box"})]),t("p",{staticClass:"label-text",on:{click:e.toggleUpdatePrice}},[e._v("Update price")]),t("img",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Update ETC price for a small gas fee",expression:"'Update ETC price for a small gas fee'"}],staticClass:"info-icon",attrs:{src:a("57e9"),alt:""}})]),t("button",{staticClass:"btn action-btn",attrs:{disabled:"Nothing to do"===e.actionBtnText},on:{click:e.actionHandler}},[e._v(" "+e._s(e.actionBtnText)+" ")])])])},r=[];const s=()=>a.e("chunk-6bc0cf3f").then(a.bind(null,"6618")),l=()=>a.e("chunk-5924a226").then(a.bind(null,"df5d")),o=()=>a.e("chunk-814e4cd0").then(a.bind(null,"ac53")),n=()=>a.e("chunk-2c975437").then(a.bind(null,"1392"));var u={props:{balance:{required:!0},pairBalance:{require:!0},tokenName:{type:String,required:!0},tokenToUsd:{type:Number,default:1},tokenPairToUsd:{type:Number,default:1},tokenPairName:{type:String,required:!0},userTotalCollateral:{required:!0},userTotalBorrowed:{required:!0},totalBorrowElastic:{required:!0},totalBorrowBase:{required:!0},actionType:{type:String,required:!0},tokenDecimals:{type:Number,required:!0},tokenPairDecimals:{type:Number,required:!0},ltv:{type:Number,required:!0},isUpdatePrice:{type:Boolean}},data(){return{userBalance:null,mainValue:"",mainValueError:"",pairValue:"",pairValueError:"",percentValue:"",updatePrice:!1,multiplier:1,slipage:1,showLeverage:!1}},watch:{actionType(){this.clearData()}},computed:{liquidationMultiplier(){return(200-this.ltv)/100},showMax(){return"borrow"!==this.actionType},maxMainValue(){if("borrow"===this.actionType)return this.userBalance;if("repay"===this.actionType){if(parseFloat(this.userTotalBorrowed)>parseFloat(this.parsedPairBalance))return this.parsedPairBalance;const e=parseFloat(this.totalBorrowElastic)/parseFloat(this.totalBorrowBase),t=parseFloat(this.userTotalBorrowed)*e;return t}return 0},mainValueTokenName(){return"borrow"===this.actionType?this.tokenName:"repay"===this.actionType?this.tokenPairName:"XX"},pairValueTokenName(){return"borrow"===this.actionType?this.tokenPairName:"repay"===this.actionType?this.tokenName:"XX"},pairValueDecimals(){return"borrow"===this.actionType?this.tokenPairDecimals:"repay"===this.actionType?this.tokenDecimals:18},mainValueDecimals(){return"borrow"===this.actionType?this.tokenDecimals:"repay"===this.actionType?this.tokenPairDecimals:18},parsedPairBalance(){return this.$ethers.utils.formatUnits(this.pairBalance.toString(),this.tokenPairDecimals)},maxPairValue(){if("borrow"===this.actionType){let e,t;return this.mainValue?(e=this.mainValue/this.tokenToUsd,t=e/100*(this.ltv-1)):(e=this.userTotalCollateral/this.tokenToUsd,t=e/100*(this.ltv-1)-this.userTotalBorrowed),t}if("repay"===this.actionType){const e=parseFloat(+this.userTotalCollateral).toFixed(20);let t=new RegExp("^-?\\d+(?:.\\d{0,"+(this.pairValueDecimals||-1)+"})?");return e.toString().match(t)[0]}return 0},signer(){return this.$store.getters.getSigner},actionBtnText(){if(this.mainValueError||this.pairValueError)return"Nothing to do";if("borrow"===this.actionType){if(this.mainValue&&this.pairValue&&parseFloat(this.pairValue)>0)return"Add collateral and borrow";if(this.mainValue)return"Add collateral";if(this.pairValue)return"Borrow"}if("repay"===this.actionType){if(this.mainValue&&this.pairValue&&parseFloat(this.pairValue)>0)return"Remove collateral and repay";if(this.mainValue)return"Repay";if(this.pairValue)return"Remove collateral"}return"Nothing to do"},liquidationPrice(){if(!this.percentValue)return"xxx.xx";if(!this.mainValue&&this.pairValue){const e=(+this.userTotalBorrowed+ +this.pairValue)*this.tokenToUsd/+this.userTotalCollateral*(1/this.tokenToUsd)*this.liquidationMultiplier;return e.toFixed(2)}if(this.mainValue&&this.pairValue){const e=+this.pairValue*this.tokenToUsd/+this.mainValue*(1/this.tokenToUsd)*this.liquidationMultiplier||0;return e.toFixed(2)}return"xxx.xx"}},methods:{updateMultiplier(e){this.multiplier=e},updateSlipage(e){this.slipage=e},toggleUpdatePrice(){this.updatePrice=!this.updatePrice},toggleShowLeverage(){!0===this.showLeverage&&(this.multiplier=1),this.showLeverage=!this.showLeverage},toFixed(e,t){let a=new RegExp("^-?\\d+(?:.\\d{0,"+(t||-1)+"})?");return e.toString().match(a)[0]},actionHandler(){if(this.mainValue&&this.pairValue&&parseFloat(this.pairValue)>0){if("borrow"===this.actionType){const e=this.$ethers.utils.parseUnits(this.mainValue.toString(),this.mainValueDecimals),t=this.$ethers.utils.parseUnits(this.toFixed(this.pairValue,6),this.pairValueDecimals),a={collateralAmount:e,amount:t,updatePrice:this.updatePrice};if(this.multiplier>1)return a.amount=this.toFixed(this.pairValue,6),this.multiplierHandle(a,"addAndBorrowMultiple"),!1;this.$emit("addAndBorrow",a)}if("repay"===this.actionType){let e=this.$ethers.utils.parseUnits(this.toFixed(this.mainValue,6),this.mainValueDecimals),t=this.$ethers.utils.parseUnits(this.pairValue.toString(),this.pairValueDecimals),a={collateralAmount:e,amount:t,updatePrice:this.updatePrice};if(this.mainValue===this.maxMainValue&&this.pairValue===this.maxPairValue)return e=this.$ethers.utils.parseUnits(this.userTotalBorrowed,this.mainValueDecimals),t=this.$ethers.utils.parseUnits(this.userTotalCollateral,this.pairValueDecimals),a={collateralAmount:e,amount:t,updatePrice:this.updatePrice},this.$emit("removeAndRepayMax",a),!1;this.$emit("removeAndRepay",a)}return!1}if(this.mainValue){if("borrow"===this.actionType){const e=this.$ethers.utils.parseUnits(this.mainValue.toString(),this.mainValueDecimals),t={amount:e,updatePrice:this.updatePrice};this.$emit("addCollateral",t)}if("repay"===this.actionType){const e=this.$ethers.utils.parseUnits(this.toFixed(this.mainValue,6),this.mainValueDecimals),t={amount:e,updatePrice:this.updatePrice};this.$emit("repay",t)}return!1}if(this.pairValue){if("borrow"===this.actionType){const e=this.$ethers.utils.parseUnits(this.toFixed(this.pairValue,6),this.pairValueDecimals),t={amount:e,updatePrice:this.updatePrice};if(this.multiplier>1)return t.amount=this.toFixed(this.pairValue,6),this.multiplierHandle(t,"borrowMultiple"),!1;this.$emit("borrow",t)}if("repay"===this.actionType){const e=this.$ethers.utils.parseUnits(this.pairValue.toString(),this.pairValueDecimals),t={amount:e,updatePrice:this.updatePrice};this.$emit("removeCollateral",t)}return!1}},multiplierHandle(e,t){const a=parseFloat(this.percentValue);if(!a)return!1;const i=(100-this.slipage)/100,r=a/100;let s=.995*e.amount,l=0;for(let p=this.multiplier;p>0;p--)l+=+s,s*=r;const o=this.$ethers.utils.parseUnits(this.toFixed(l,this.pairValueDecimals),this.pairValueDecimals),n=l*this.tokenToUsd*i,u=this.$ethers.utils.parseUnits(this.toFixed(n,this.mainValueDecimals),this.mainValueDecimals),h={...e,amount:o,minExpected:u};this.$emit(t,h)},clearData(){this.mainValue="",this.mainValueError="",this.pairValue="",this.pairValueError="",this.percentValue=""},updateMainValue(e){if(this.mainValue=e,parseFloat(e)>parseFloat(this.maxMainValue))return this.mainValueError="The value cannot be greater than "+this.maxMainValue,!1;if(this.mainValueError="","repay"===this.actionType){const t=this.pairValue/this.maxPairValue*100,a=e/this.userTotalBorrowed*100,i=this.userTotalBorrowed/this.tokenPairToUsd,r=this.userTotalCollateral/this.tokenToUsd,s=r-i,l=s/r*100;return t<=a&&t<l?(this.pairValueError="",!1):(this.pairValueError="You have insufficient collateral. Please enter a smaller amount or repay more.",!1)}this.pairValue&&this.updatePairValue(this.pairValue),this.percentValue&&e&&(this.pairValue=this.maxPairValue*this.percentValue/this.ltv)},updatePairValue(e){if(parseFloat(e)>parseFloat(this.maxPairValue))return this.pairValueError="The value cannot be greater than "+this.maxPairValue,!1;if("repay"===this.actionType){e||(this.pairValueError="",this.pairValue=e);const t=this.userTotalBorrowed/this.tokenPairToUsd,a=this.userTotalCollateral/this.tokenToUsd,i=a-t,r=i/a*100,s=e/this.maxPairValue*100,l=this.mainValue/this.userTotalBorrowed*100;return r<s&&s>l?(this.pairValueError="You have insufficient collateral. Please enter a smaller amount or repay more.",this.pairValue=e,!1):(this.pairValueError="",this.pairValue=e,!1)}if(this.pairValueError="",this.pairValue=e,!e)return this.updatePercentValue(""),!1;this.updatePercentValue(parseFloat(this.pairValue/this.maxPairValue*this.ltv).toFixed(4),!0)},updatePercentValue(e,t){if(this.percentValue=e,t)return!1;this.mainValue&&e&&(this.pairValue=this.maxPairValue*e/this.ltv)},async getUserBalance(){const e=this.$ethers.utils.formatUnits(this.balance.toString(),this.tokenDecimals);this.userBalance=e}},async created(){await this.getUserBalance()},components:{ValueInput:s,LiquidationRules:l,LeverageBar:o,SlipageBlock:n}},h=u,p=(a("4c09"),a("2877")),c=Object(p["a"])(h,i,r,!1,null,"7097f814",null);t["default"]=c.exports},f612:function(e,t,a){}}]);